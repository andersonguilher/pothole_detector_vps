<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConservApp AI - Documenta√ß√£o T√©cnica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .nav-link.active {
            background-color: #eef2ff;
            color: #4338ca;
            border-left: 3px solid #4f46e5;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800">

    <div class="flex min-h-screen">
        <!-- Sidebar Navigation -->
        <aside class="w-64 bg-white shadow-md p-4 space-y-2 fixed h-full">
            <div class="flex items-center space-x-2 p-3 border-b">
                <i class="fa-solid fa-road text-yellow-400 text-2xl"></i>
                <span class="text-xl font-bold text-blue-900">ConservApp AI</span>
            </div>
            <nav class="flex flex-col space-y-1">
                <a href="#introducao"
                    class="nav-link px-3 py-2 rounded-md font-medium text-slate-600 hover:bg-slate-100">
                    <i class="fa-solid fa-house w-6"></i> Introdu√ß√£o
                </a>
                <a href="#arquitetura"
                    class="nav-link px-3 py-2 rounded-md font-medium text-slate-600 hover:bg-slate-100">
                    <i class="fa-solid fa-sitemap w-6"></i> Arquitetura
                </a>
                <a href="#backend" class="nav-link px-3 py-2 rounded-md font-medium text-slate-600 hover:bg-slate-100">
                    <i class="fa-solid fa-code w-6"></i> Backend
                </a>
                <a href="#frontend" class="nav-link px-3 py-2 rounded-md font-medium text-slate-600 hover:bg-slate-100">
                    <i class="fa-solid fa-display w-6"></i> Frontend
                </a>
                <a href="#execucao" class="nav-link px-3 py-2 rounded-md font-medium text-slate-600 hover:bg-slate-100">
                    <i class="fa-solid fa-play w-6"></i> Execu√ß√£o e Deploy
                </a>
                <a href="#customizacao"
                    class="nav-link px-3 py-2 rounded-md font-medium text-slate-600 hover:bg-slate-100">
                    <i class="fa-solid fa-wrench w-6"></i> Customiza√ß√£o
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="ml-64 flex-1 p-8">

            <!-- Se√ß√£o Introdu√ß√£o -->
            <section id="introducao" class="content-section active">
                <h1 class="text-4xl font-bold text-blue-900 mb-4">Documenta√ß√£o T√©cnica</h1>
                <p class="text-lg text-slate-600 mb-6">Vis√£o geral do sistema de detec√ß√£o de patologias em vias urbanas.
                </p>
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <p>O <strong>ConservApp AI</strong> √© uma solu√ß√£o baseada em Python, FastAPI e YOLOv8, projetada
                        para identificar e analisar anomalias em vias p√∫blicas, como buracos e bueiros danificados. A
                        aplica√ß√£o oferece uma interface web para upload de imagens, processa as detec√ß√µes em tempo real
                        e gera um relat√≥rio t√©cnico com estimativas de reparo.</p>
                </div>
            </section>

            <!-- Se√ß√£o Arquitetura -->
            <section id="arquitetura" class="content-section">
                <h2 class="text-3xl font-bold text-blue-900 mb-6">Arquitetura do Sistema</h2>
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-semibold text-lg mb-2">Estrutura de Arquivos</h3>
                    <pre class="bg-slate-100 p-4 rounded-md text-sm">
üìÇ pothole_detector/
 ‚îú‚îÄ‚îÄ main.py              # L√≥gica da API FastAPI e pipeline de detec√ß√£o
 ‚îú‚îÄ‚îÄ models/                # Modelos .pt (YOLOv8)
 ‚îÇ    ‚îú‚îÄ‚îÄ buracos_box.pt
 ‚îÇ    ‚îú‚îÄ‚îÄ buracos_seg.pt
 ‚îÇ    ‚îî‚îÄ‚îÄ bueiros_det.pt
 ‚îú‚îÄ‚îÄ templates/
 ‚îÇ    ‚îî‚îÄ‚îÄ index.html       # Interface do usu√°rio (HTML + TailwindCSS)
 ‚îú‚îÄ‚îÄ doc.html               # Esta documenta√ß√£o
 ‚îú‚îÄ‚îÄ requirements.txt     # Depend√™ncias do projeto
 ‚îî‚îÄ‚îÄ README.md              # Resumo do projeto
</pre>
                    <h3 class="font-semibold text-lg mt-6 mb-2">Fluxo de Dados</h3>
                    <div class="flex items-center justify-center">
                        <img src="https://i.imgur.com/8a5zR2s.png" alt="Fluxo de Dados">
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o Backend -->
            <section id="backend" class="content-section">
                <h2 class="text-3xl font-bold text-blue-900 mb-6">Backend (FastAPI)</h2>
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-semibold text-lg mb-2">Endpoint Principal: <code>/detectar</code></h3>
                    <p>Este endpoint recebe as imagens e as configura√ß√µes de detec√ß√£o, retornando um JSON com os
                        resultados.</p>
                    <ul class="list-disc list-inside bg-slate-50 p-4 rounded-md mt-4">
                        <li><strong>M√©todo:</strong> <code>POST</code></li>
                        <li><strong>Payload:</strong> <code>multipart/form-data</code></li>
                    </ul>

                    <h4 class="font-semibold mt-4 mb-2">Par√¢metros de Entrada</h4>
                    <table class="w-full text-left border">
                        <thead class="bg-slate-100">
                            <tr>
                                <th class="p-2 border">Par√¢metro</th>
                                <th class="p-2 border">Tipo</th>
                                <th class="p-2 border">Descri√ß√£o</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="p-2 border"><code>files</code></td>
                                <td class="p-2 border">Lista de <code>UploadFile</code></td>
                                <td class="p-2 border">Imagens a serem processadas.</td>
                            </tr>
                            <tr>
                                <td class="p-2 border"><code>confidence_buraco</code></td>
                                <td class="p-2 border"><code>float</code></td>
                                <td class="p-2 border">Confian√ßa m√≠nima para detec√ß√£o de buracos (0.1-0.9).</td>
                            </tr>
                            <tr>
                                <td class="p-2 border"><code>confidence_bueiro</code></td>
                                <td class="p-2 border"><code>float</code></td>
                                <td class="p-2 border">Confian√ßa m√≠nima para detec√ß√£o de bueiros (0.1-0.9).</td>
                            </tr>
                            <tr>
                                <td class="p-2 border"><code>detection_mode</code></td>
                                <td class="p-2 border"><code>string</code></td>
                                <td class="p-2 border">'box' (r√°pido) ou 'mask' (preciso).</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4 class="font-semibold mt-6 mb-2">Estrutura de Resposta (JSON)</h4>
                    <pre class="bg-slate-800 text-white p-4 rounded-md text-sm custom-scrollbar">{
    "batch_results": [
        {
            "file_name": "imagem1.jpg",
            "image_b64": "data:image/jpeg;base64,...",
            "report_data": [
                { "id": "#1", "tipo": "Buraco", "detalhe": "0.1234 m¬≤", ... }
            ],
            ...
        }
    ],
    "grand_totals": { "m2": "1.2345", "ton": "0.567", "count": 5 }
}</pre>
                </div>
            </section>

            <!-- Se√ß√£o Frontend -->
            <section id="frontend" class="content-section">
                <h2 class="text-3xl font-bold text-blue-900 mb-6">Frontend (HTML + TailwindCSS)</h2>
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <p>A interface √© uma p√°gina √∫nica (SPA) constru√≠da com HTML e estilizada com TailwindCSS, o que a
                        torna responsiva e f√°cil de manter.</p>
                    <h3 class="font-semibold text-lg mt-4 mb-2">Principais Componentes da UI:</h3>
                    <ul class="list-disc list-inside space-y-2">
                        <li><strong>Painel de Configura√ß√£o:</strong> Sliders para ajustar a confian√ßa e um seletor para
                            o modo de detec√ß√£o.</li>
                        <li><strong>√Årea de Upload:</strong> Permite arrastar e soltar ou selecionar arquivos de imagem.
                        </li>
                        <li><strong>Relat√≥rio de Totais:</strong> Exibe os totais de √°rea danificada, CBUQ estimado e
                            n√∫mero de ocorr√™ncias.</li>
                        <li><strong>Grid de Resultados:</strong> Mostra cada imagem processada com sua respectiva tabela
                            de detec√ß√µes.</li>
                    </ul>
                </div>
            </section>

            <!-- Se√ß√£o Execu√ß√£o e Deploy -->
            <section id="execucao" class="content-section">
                <h2 class="text-3xl font-bold text-blue-900 mb-6">Execu√ß√£o e Deploy</h2>
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-semibold text-lg mb-2">1. Instala√ß√£o de Depend√™ncias</h3>
                    <pre class="bg-slate-100 p-4 rounded-md">pip install -r requirements.txt</pre>
                    <h3 class="font-semibold text-lg mt-6 mb-2">2. Execu√ß√£o do Servidor (com Proxy Reverso)</h3>
                    <pre
                        class="bg-slate-100 p-4 rounded-md">uvicorn main:app --reload --host 127.0.0.1 --port 8000 --root-path /detector</pre>
                    <p class="mt-2">Com um proxy reverso configurado para <code>/detector/</code>, acesse a aplica√ß√£o em
                        <a href="http://localhost/detector/"
                            class="text-blue-600 hover:underline">http://localhost/detector/</a>.
                    </p>
                </div>
            </section>

            <!-- Se√ß√£o Customiza√ß√£o -->
            <section id="customizacao" class="content-section">
                <h2 class="text-3xl font-bold text-blue-900 mb-6">Customiza√ß√£o</h2>
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h3 class="font-semibold text-lg mb-2">Trocando os Modelos de IA</h3>
                    <p>Para usar seus pr√≥prios modelos, simplesmente substitua os arquivos <code>.pt</code> na pasta
                        <code>/models</code> e ajuste os nomes no in√≠cio do arquivo <code>main.py</code>:
                    </p>
                    <pre class="bg-slate-100 p-4 rounded-md text-sm">
# Em main.py
try: models["box"] = YOLO("models/seu_modelo_box.pt")
except: ...
</pre>
                    <h3 class="font-semibold text-lg mt-6 mb-2">Ajustando Par√¢metros F√≠sicos</h3>
                    <p>As constantes para c√°lculo de √°rea e massa de CBUQ podem ser alteradas no <code>main.py</code>
                        para refletir diferentes realidades de engenharia.</p>
                    <pre class="bg-slate-100 p-4 rounded-md text-sm">
# Em main.py
PIXEL_TO_CM2 = 0.04       # Ajuste conforme a calibra√ß√£o da c√¢mera
DENSIDADE_CBUQ_TM3 = 2.4
ESPESSURA_CM = 5
</pre>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.content-section');

            function updateActiveState() {
                let currentHash = window.location.hash || '#introducao';

                navLinks.forEach(link => {
                    if (link.getAttribute('href') === currentHash) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });

                sections.forEach(section => {
                    if ('#' + section.id === currentHash) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    // e.preventDefault(); // Comentado para permitir a navega√ß√£o por hash
                    setTimeout(updateActiveState, 0);
                });
            });

            window.addEventListener('hashchange', updateActiveState);
            updateActiveState(); // Initial load
        });
    </script>

</body>

</html>